PREFIX ragno: <http://purl.org/stuff/ragno/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dcterms: <http://purl.org/dc/terms/>

# Extract all connections from the knowledge base
# Creates a graph view focusing on element-to-interaction connections
# Updated to work with actual data structure (ragno:connectsTo relationships)
CONSTRUCT {
    ?source ragno:connectsTo ?target ;
            rdf:type ragno:Element .
    ?target rdf:type ?targetType ;
            dcterms:created ?created .
    
    # Create simplified direct relationships for easier traversal
    ?source ragno:relatedTo ?target ;
            ragno:connectionType "connectsTo" .
}
WHERE {
    GRAPH <${graphURI}> {
        ?source ragno:connectsTo ?target .
        
        # Get source type (should be ragno:Element)
        OPTIONAL { ?source rdf:type ragno:Element }
        
        # Get target type and properties  
        OPTIONAL { ?target rdf:type ?targetType }
        OPTIONAL { ?target dcterms:created ?created }
        
        # Filter out self-connections (though unlikely with this data structure)
        FILTER(?source != ?target)
    }
}
ORDER BY ?source ?created